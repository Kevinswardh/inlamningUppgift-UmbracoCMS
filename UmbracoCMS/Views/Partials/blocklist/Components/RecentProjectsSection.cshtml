@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<
Umbraco.Cms.Core.Models.Blocks.BlockListItem < RecentProjectsSection >
>
@using Umbraco.Cms.Web.Common.PublishedModels;
@using Umbraco.Extensions;

@{
    var content = (RecentProjectsSection)Model.Content;

    var root = Umbraco.ContentAtRoot()?.FirstOrDefault();

    var projects = root?
        .DescendantsOfType("projectDetail")
        .Where(x => x.IsVisible())
        .OrderByDescending(x => x.CreateDate)
        .Take(4)
        .ToList();
}

@if (projects != null && projects.Any())
{
    <section class="py-24 bg-white">

        <!-- HEADER -->
        <div class="max-w-7xl mx-auto px-4 mb-10 text-left">

            <p class="text-xs tracking-[3px] uppercase font-semibold text-[var(--color-secondary)] mb-3">
                OUR PROJECTS
            </p>

            <h2 class="text-4xl md:text-5xl font-bold text-[var(--color-primary)]">
                RECENT PROJECTS
            </h2>

        </div>

        <!-- GRID -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8 max-w-7xl mx-auto px-4">

            @foreach (var item in projects)
            {
                var thumb = item.Value<IPublishedContent>("projectDetailThumbnail");

                <a href="@item.Url()" class="group block rounded-lg overflow-hidden shadow-md relative">

                    <!-- IMAGE (STÖRRE) -->
                    <div class="h-72 w-full overflow-hidden">
                        @if (thumb != null)
                        {
                            <img src="@thumb.Url()"
                                 class="w-full h-full object-cover transition-all duration-300 group-hover:scale-105" />
                        }
                    </div>

                    <!-- OVERLAY INFO -->
                    <div class="absolute bottom-0 left-0 right-0
                                        bg-black/45 backdrop-blur-sm p-5 text-white">

                        <h3 class="text-lg font-semibold mb-1">@item.Name</h3>

                        <div class="mt-1 flex items-center gap-2 text-sm font-medium">
                            <span>Read more</span>
                            <span class="text-xl transform group-hover:translate-x-1 transition-all duration-300">➜</span>
                        </div>
                    </div>

                </a>
            }

        </div>

    </section>
}
